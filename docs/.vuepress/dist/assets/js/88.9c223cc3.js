(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{299:function(s,t,a){"use strict";a.r(t);var e=a(0),i=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"adversarial-inverse-reinforcement-learning"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adversarial-inverse-reinforcement-learning"}},[s._v("#")]),s._v(" Adversarial Inverse Reinforcement Learning")]),s._v(" "),a("p",[a("code",[s._v("Learning Robust Rewards With Adversarial Inverse Reinforcement Learning")])]),s._v(" "),a("p",[a("code",[s._v("Justin Fu, Katie Luo, Sergey Levine")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("关注点")]),s._v(" "),a("p",[s._v("这篇文章的关键就是解决GAIL训练出的Reward Function没有用的致命缺点。仔细看作者是如何解决这个问题的。")])]),s._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[s._v("#")]),s._v(" Abstract")]),s._v(" "),a("p",[s._v("一开始作者提到:")]),s._v(" "),a("blockquote",[a("p",[s._v("Inverse reinforcement learning holds the promise of automatic reward acquisition, but has proven exceptionally difficult to apply to large, high-dimensional problems with unknown dynamics.")])]),s._v(" "),a("p",[s._v("也就是说，虽然都说反向强化学习可以自动学习到Reward Function, 但对于高维状态空间，Unknown Dynamics的情况是会有问题的。这也就导致了IRL用在实际当中有很多的问题。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("Dynamics是什么?")]),s._v(" "),a("p",[s._v("简单来说, Dynamics就是指的"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("msub",[a("mi",[s._v("s")]),a("mrow",[a("mi",[s._v("t")]),a("mo",[s._v("+")]),a("mi",[s._v("x")])],1)],1),a("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),a("msub",[a("mi",[s._v("s")]),a("mi",[s._v("t")])],1),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msub",[a("mi",[s._v("a")]),a("mi",[s._v("t")])],1),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p(s_{t+x}|s_t,a_t)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit"},[s._v("x")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mord mathrm"},[s._v("∣")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v(", 其中 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("t")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("t")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.61508em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.61508em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")])])])]),s._v("为可取的任意值。这个Dynamics又叫model;")]),s._v(" "),a("p",[s._v("Known Dynamics指的就是知道这个状态转移概率,那么对应model-based;\nUnknown Dynamics指的是不知道这个转移概率, 那么对应model-free。")]),s._v(" "),a("p",[s._v("这里有个技巧来判断某个算法是model-based还是model-free:")]),s._v(" "),a("p",[s._v("在agent执行它的动作之前，它是否能对下一步的状态和回报做出预测，如果可以，那么就是model-based方法，如果不能，即为model-free方法。")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("思考")]),s._v(" "),a("p",[s._v("现在都不能够望文生义了, 强化学习里面有一节叫做'Dynamic Programming', 中文翻译过来叫做\"动态规划\"。如果不了解Dynamic指的是"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("msub",[a("mi",[s._v("s")]),a("mrow",[a("mi",[s._v("t")]),a("mo",[s._v("+")]),a("mi",[s._v("x")])],1)],1),a("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),a("msub",[a("mi",[s._v("s")]),a("mi",[s._v("t")])],1),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msub",[a("mi",[s._v("a")]),a("mi",[s._v("t")])],1),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p(s_{t+x}|s_t,a_t)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit"},[s._v("x")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mord mathrm"},[s._v("∣")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("t")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v(',你根本想不到是什么意思。"动态", 在这里真的就是指的"态(state)"的变化规律。"动态规划"的意思就是知道了态的变化规律后，再通过一系列的算法找到最优的策略。')])]),s._v(" "),a("h2",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[s._v("#")]),s._v(" Introduction")]),s._v(" "),a("p",[s._v("这一部分作者提到:")]),s._v(" "),a("blockquote",[a("p",[s._v("Part of the challenge is that IRL is an ill-defined problem, since there are many optimal policies that can explain a set of demonstrations, and many rewards that can explain an optimal policy.")])]),s._v(" "),a("p",[s._v("也就是说IRL问题的提出本事就是有毛病(ill-defined)的, 主要体现在这两点:")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("许多最优策略可以用来解释专家的轨迹")]),s._v(";")]),s._v(" "),a("li",[a("strong",[s._v("许多的Reward Function可以用来解释最优策略")]),s._v(";")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("最优策略")]),s._v(" "),a("p",[s._v("这里提到了最优策略，我们就提一下什么是最优策略。")]),s._v(" "),a("p",[s._v("说最优之前我们要说什么样的策略才是好的策略。\n要是一个策略"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("π")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")])])])]),s._v("比另一个策略"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("π")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi'")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.751892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.751892em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("好,那就要"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("π")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")])])])]),s._v("在每一个状态下对应的回报的均值都要比"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("π")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi'")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.751892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.751892em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("的大。")]),s._v(" "),a("p",[s._v("那么就可以找到一个(或多个)策略"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("π")]),a("mo",[s._v("∗")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi^*")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.688696em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.688696em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("比其他所有的策略都好(或者一样好)，那么"),a("mark",[s._v("这些")]),s._v("策略"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("π")]),a("mo",[s._v("∗")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\pi^*")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.688696em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.688696em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("就被叫做最优的策略。")])]),s._v(" "),a("p",[s._v("作者指出, 2008年Ziebart提出的The maximum entropy(MaxEnt) IRL这种方法是用来处理第一种歧义的的。那MaxEnt IRL是怎么做到的呢?")]),s._v(" "),a("p",[s._v("最大熵原理是指，在学习概率模型时，在所有满足约束的概率模型（分布）中，熵最大的模型是最好的模型。这是因为，通过熵最大所选取的模型，没有对未知（即除了约束已知外）做任何主观假设。也就是说，除了约束条件外，我们不知道任何其他信息。")]),s._v(" "),a("p",[s._v("最大熵IRL最后会学到一个概率分布"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p(\\tau)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"background"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[s._v("#")]),s._v(" Background")]),s._v(" "),a("p",[s._v("在Background部分，作者一开始就提到他们的IRL算法是建立在Maximum causal entropy这套方法上的。")]),s._v(" "),a("p",[s._v("那什么是Maximum causal entropy 呢? 我找到了2010年Ziebart的博士论文。")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("什么是Maximum causal entropy?")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("什么是soft Q-function?")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("什么是energy-based model?")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("什么是Boltzmann distribution?")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("p")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mrow",[a("mi",{attrs:{mathvariant:"bold"}},[s._v("x")])],1),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mn",[s._v("1")])],1),a("mrow",[a("mi",[s._v("Z")])],1)],1),a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("E")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mrow",[a("mi",{attrs:{mathvariant:"bold"}},[s._v("x")])],1),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p_{\\theta}(\\mathbf{x})=\\frac{1}{Z} \\exp \\left(-E_{\\theta}(\\mathbf{x})\\right)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.32144em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.00744em","vertical-align":"-0.686em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathbf"},[s._v("x")])]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[s._v("Z")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})]),a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[s._v("E")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.05764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathbf"},[s._v("x")])]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])])])])])])]),s._v(" "),a("p",[s._v("这个分布是通过最大熵原理优化得到的。")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("什么是最大信息熵?")]),s._v(" "),a("p",[s._v("最大熵模型想要在符合已知知识的前提下, 对未知事物不做任何假设。")])]),s._v(" "),a("p",[s._v("由GAN的目标函数可以得到,最优的Discriminator有下面的形式:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("D")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1),a("mrow",[a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("q")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D^{*}(\\tau)=\\frac{p(\\tau)}{p(\\tau)+q(\\tau)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.427em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.2300000000000001em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("p",[s._v("其中"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")])])])]),s._v("是真实的分布, "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("q")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("q")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")])])])]),s._v("是Generator对应的分布。我们用一组参数去拟合真实分布于是可以得到:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("msub",[a("mover",{attrs:{accent:"true"}},[a("mrow",[a("mi",[s._v("p")])],1),a("mo",[s._v("~")])],1),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1),a("mrow",[a("msub",[a("mover",{attrs:{accent:"true"}},[a("mrow",[a("mi",[s._v("p")])],1),a("mo",[s._v("~")])],1),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("q")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D_{\\theta}(\\tau)=\\frac{\\tilde{p}_{\\theta}(\\tau)}{\\tilde{p}_{\\theta}(\\tau)+q(\\tau)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.427em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord accent"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")])])]),a("span",{staticStyle:{top:"-0.35em","margin-left":"0.16668em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"accent-body"},[a("span",[s._v("~")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.2300000000000001em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord accent"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")])])]),a("span",{staticStyle:{top:"-0.35em","margin-left":"0.16668em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"accent-body"},[a("span",[s._v("~")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("p",[s._v("为了和MaxEnt IRL联系起来，我们用Boltzmann distribution代替"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("p")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("p")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")])])])]),s._v(",这样做的一个原因是我们认为Boltzmann distribution\n可以让我们满足最大熵原理，认为这样是合理的。于是我们得到:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mfrac",[a("mrow",[a("mn",[s._v("1")])],1),a("mrow",[a("mi",[s._v("Z")])],1)],1),a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("c")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1),a("mrow",[a("mfrac",[a("mrow",[a("mn",[s._v("1")])],1),a("mrow",[a("mi",[s._v("Z")])],1)],1),a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("c")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("+")]),a("mi",[s._v("q")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D_{\\theta}(\\tau)=\\frac{\\frac{1}{Z} \\exp \\left(-c_{\\theta}(\\tau)\\right)}{\\frac{1}{Z} \\exp \\left(-c_{\\theta}(\\tau)\\right)+q(\\tau)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.580108em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.660216em","vertical-align":"-1.080108em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.7351080000000001em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord reset-textstyle textstyle cramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.345em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[s._v("Z")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.394em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})]),a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle cramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("c")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.735em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord reset-textstyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.345em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[s._v("Z")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.394em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})]),a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("c")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("p",[s._v("接下来进一步简化就可以得到:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1)],1),a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1),a("mo",[s._v("+")]),a("mi",[s._v("π")]),a("mo",[s._v("(")]),a("mi",[s._v("τ")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D_{\\theta}(\\tau)=\\frac{\\exp \\left\\{f_{\\theta}(\\tau)\\right\\}}{\\exp \\left\\{f_{\\theta}(\\tau)\\right\\}+\\pi(\\tau)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.427em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle cramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.2300000000000001em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.1132em"}},[s._v("τ")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("h2",{attrs:{id:"airl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#airl"}},[s._v("#")]),s._v(" AIRL")]),s._v(" "),a("p",[s._v("文章里面提到，使用整个轨迹喂给网络训练可能并不很好。于是简化得到:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1)],1),a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1),a("mo",[s._v("+")]),a("mi",[s._v("π")]),a("mo",[s._v("(")]),a("mi",[s._v("a")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D_{\\theta}(s, a)=\\frac{\\exp \\left\\{f_{\\theta}(s, a)\\right\\}}{\\exp \\left\\{f_{\\theta}(s, a)\\right\\}+\\pi(a | s)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.427em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle cramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mord mathrm"},[s._v("∣")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.2300000000000001em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("p",[s._v("文章里面提到，这样的修改可以在模仿学习上得到很好的效果。但是对于得到Reward Function就差强人意了。可以说这个Reward是没有一点用的。\n他们也做了实验，发现这个学到的Reward完全不行。")]),s._v(" "),a("p",[s._v("接下来讨论，为什么Reward会出现这么糟糕的情况。")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("疑问")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("文章里面说的是他们学到的Reward Function之和State有关，那为什么表达式里面却是"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("r")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("r_{\\theta,\\phi} (s,a,s')")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.751892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.038em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v("？")])]),s._v(" "),a("li",[a("p",[s._v("从后面的实验结果来看, 貌似这套算法的到的Reward Function是否只是和Statte相关还是可以任意切换的, 是怎么做到的?")])])])]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("Policy invariance under reward transformations: Theory and application to reward shaping. In International Conference on Machine Learning (ICML), 1999")]),s._v("文章中提到在下面的Reward的变化中:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mover",{attrs:{accent:"true"}},[a("mrow",[a("mi",[s._v("r")])],1),a("mo",[s._v("^")])],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("mi",[s._v("r")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("+")]),a("mi",[s._v("γ")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("Φ")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("−")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("Φ")]),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\hat{r}\\left(s, a, s^{\\prime}\\right)=r\\left(s, a, s^{\\prime}\\right)+\\gamma \\Phi\\left(s^{\\prime}\\right)-\\Phi(s)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.801892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.051892em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord accent"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"mord displaystyle textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")])])]),a("span",{staticStyle:{top:"0em","margin-left":"0.11112em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"accent-body"},[a("span",[s._v("^")])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[s._v("γ")]),a("span",{staticClass:"mord mathrm"},[s._v("Φ")]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mord mathrm"},[s._v("Φ")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("对于任何的函数"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("Φ")]),a("mo",[s._v(":")]),a("mrow",[a("mi",{attrs:{mathvariant:"script"}},[s._v("S")])],1),a("mo",[s._v("→")]),a("mrow",[a("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\Phi: \\mathcal{S} \\rightarrow \\mathbb{R}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68889em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68889em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("Φ")]),a("span",{staticClass:"mrel"},[s._v(":")]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathcal",staticStyle:{"margin-right":"0.075em"}},[s._v("S")])]),a("span",{staticClass:"mrel"},[s._v("→")]),a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathbb"},[s._v("R")])])])])]),s._v(", 最优策略都不会发生改变。")]),s._v(" "),a("h2",{attrs:{id:"使用airl学习一个disentangled-reward"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用airl学习一个disentangled-reward"}},[s._v("#")]),s._v(" 使用AIRL学习一个Disentangled Reward")]),s._v(" "),a("p",[s._v("考虑到Reward shaping 的情况我们将"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("D")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")])])])]),s._v("写成下面的形式:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1)],1),a("mrow",[a("mi",[s._v("exp")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("{")]),a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",{attrs:{fence:"true"}},[s._v("}")])],1),a("mo",[s._v("+")]),a("mi",[s._v("π")]),a("mo",[s._v("(")]),a("mi",[s._v("a")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("∣")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("D_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)=\\frac{\\exp \\left\\{f_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)\\right\\}}{\\exp \\left\\{f_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)\\right\\}+\\pi(a | s)}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.428892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.401em","vertical-align":"-0.972108em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.6859999999999999em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle cramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner textstyle cramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.289em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("π")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mord mathrm"},[s._v("∣")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mop"},[s._v("exp")]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("{")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("}")])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"1em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),s._v(" "),a("p",[s._v("其中"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("f_{\\theta, \\phi}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.980548em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("被限制成了下面的表达式:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("msub",[a("mi",[s._v("g")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("γ")]),a("msub",[a("mi",[s._v("h")]),a("mrow",[a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("h")]),a("mrow",[a("mi",[s._v("ϕ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("f_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)=g_{\\theta}(s, a)+\\gamma h_{\\phi}\\left(s^{\\prime}\\right)-h_{\\phi}(s) \n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.801892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.088em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[s._v("γ")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("h")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("h")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("这样就可以减缓对于"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("g")]),a("mrow",[a("mi",[s._v("θ")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("g_{\\theta}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("不想要的reshape.")]),s._v(" "),a("p",[s._v("这样做还有一个好处是,我们可以把 "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("g")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("g_{\\theta}(s,a)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v(", 变成"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("g")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("g_{\\theta}(s)")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),s._v(", 这样就可以使得我们的得到的reward从Environment的Dynamics中脱离出来，这样就\n可以得到更稳定的reward.")]),s._v(" "),a("p",[s._v("也就是说我们可以把"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("f_{\\theta, \\phi}")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.980548em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("写成下面的形式:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("f")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("msub",[a("mi",[s._v("g")]),a("mrow",[a("mi",[s._v("θ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("γ")]),a("msub",[a("mi",[s._v("h")]),a("mrow",[a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("h")]),a("mrow",[a("mi",[s._v("ϕ")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("f_{\\theta, \\phi}\\left(s, a,s^{\\prime}\\right)=g_{\\theta}(s)+\\gamma h_{\\phi}\\left(s^{\\prime}\\right)-h_{\\phi}(s) \n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.801892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.088em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.10764em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.03588em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[s._v("γ")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("h")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("h")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("可以证明在这样的约束下有:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("g")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("msup",[a("mi",[s._v("r")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("c")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("o")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("s")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("t")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("g^{*}(s)=r^{*}(s)+\\mathrm{const}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("c")]),a("span",{staticClass:"mord mathrm"},[s._v("o")]),a("span",{staticClass:"mord mathrm"},[s._v("n")]),a("span",{staticClass:"mord mathrm"},[s._v("s")]),a("span",{staticClass:"mord mathrm"},[s._v("t")])])])])])])]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("h")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("msup",[a("mi",[s._v("V")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("c")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("o")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("n")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("s")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("t")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("h^{*}(s)=V^{*}(s)+\\mathrm{const}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("h")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.22222em"}},[s._v("V")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("c")]),a("span",{staticClass:"mord mathrm"},[s._v("o")]),a("span",{staticClass:"mord mathrm"},[s._v("n")]),a("span",{staticClass:"mord mathrm"},[s._v("s")]),a("span",{staticClass:"mord mathrm"},[s._v("t")])])])])])])]),s._v(" "),a("p",[s._v("于是可以得到:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("f")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("msup",[a("mi",[s._v("r")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("γ")]),a("msup",[a("mi",[s._v("V")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("−")]),a("msup",[a("mi",[s._v("V")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("msup",[a("mi",[s._v("A")]),a("mrow",[a("mo",[s._v("∗")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("f^{*}\\left(s, a, s^{\\prime}\\right)=r^{*}(s)+\\gamma V^{*}\\left(s^{\\prime}\\right)-V^{*}(s)=A^{*}(s, a)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.801892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.051892em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05556em"}},[s._v("γ")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.22222em"}},[s._v("V")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.22222em"}},[s._v("V")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("A")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("∗")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"/images/ml/RL/AIRL/AIRL.png",width:"100%"}})]),s._v(" "),a("p",[s._v("从算法里面可以看到,最后RL算法中用到的reward是这样构成的:")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mi",[s._v("r")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("←")]),a("mi",[s._v("log")]),a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("−")]),a("mi",[s._v("log")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mn",[s._v("1")]),a("mo",[s._v("−")]),a("msub",[a("mi",[s._v("D")]),a("mrow",[a("mi",[s._v("θ")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("ϕ")])],1)],1),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("mi",[s._v("s")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mi",[s._v("a")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msup",[a("mi",[s._v("s")]),a("mrow",[a("mi",{attrs:{mathvariant:"normal"}},[s._v("′")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("r_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right) \\leftarrow \\log D_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)-\\log \\left(1-D_{\\theta, \\phi}\\left(s, a, s^{\\prime}\\right)\\right)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.801892em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.088em","vertical-align":"-0.286108em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("r")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mrel"},[s._v("←")]),a("span",{staticClass:"mop"},[s._v("lo"),a("span",{staticStyle:{"margin-right":"0.01389em"}},[s._v("g")])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mop"},[s._v("lo"),a("span",{staticStyle:{"margin-right":"0.01389em"}},[s._v("g")])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathrm"},[s._v("1")]),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("D")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.02778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("ϕ")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("s")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("′")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])])])])])])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("为什么AIRL能够奏效?")]),s._v(" "),a("p",[s._v("对D做了很好的约束。同样的事情可以从很多角度去解释, 但使用最大熵的概率模型就显得，那么自然。")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/u010189459/article/details/38436993",target:"_blank",rel:"noopener noreferrer"}},[s._v("CSDN: 最大熵模型(Maximum Entropy Models)详细分析"),a("OutboundLink")],1),a("br"),s._v(" "),a("a",{attrs:{href:"https://www.cnblogs.com/jesse123/p/7788064.html",target:"_blank",rel:"noopener noreferrer"}},[s._v('"我是bayesian我怕谁"系列 - Boltzmann Distribution'),a("OutboundLink")],1),a("br"),s._v(" "),a("a",{attrs:{href:"https://ai.stackexchange.com/questions/4456/whats-the-difference-between-model-free-and-model-based-reinforcement-learning",target:"_blank",rel:"noopener noreferrer"}},[s._v("Stack Exchange: model-free vs model-based"),a("OutboundLink")],1),a("br"),s._v(" "),a("a",{attrs:{href:"https://medium.com/@jonathan_hui/rl-model-based-reinforcement-learning-3c2b6f0aa323",target:"_blank",rel:"noopener noreferrer"}},[s._v("Medium: RL—Model-based Reinforcement Learning"),a("OutboundLink")],1),a("br")]),s._v(" "),a("Livere")],1)}),[],!1,null,null,null);t.default=i.exports}}]);